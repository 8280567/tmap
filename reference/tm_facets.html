<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Small multiples — tm_facets • tmap</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Small multiples — tm_facets" />
<meta property="og:description" content="Creates a tmap-element that specifies facets (small multiples). Small multiples can be created in two ways: 1) by specifying the by argument with one or two variable names, by which the data is grouped, 2) by specifying multiple variable names in any of the aesthetic argument of the layer functions (for instance, the argument col in tm_fill). This function further specifies the facets, for instance number of rows and columns, and whether the coordinate and scales are fixed or free (i.e. independent of each other). An overview of the different approaches to create facets is provided in the examples." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tmap-JSS-code.html">tmap: JSS article reproduction code</a>
    </li>
    <li>
      <a href="../articles/tmap-changes.html">tmap: version changes</a>
    </li>
    <li>
      <a href="../articles/tmap-getstarted.html">tmap: get started!</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mtennekes/tmap/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Small multiples</h1>
    <small class="dont-index">Source: <a href='https://github.com/mtennekes/tmap/blob/master/R/tm_misc_elements.R'><code>R/tm_misc_elements.R</code></a></small>
    <div class="hidden name"><code>tm_facets.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a <code><a href='https://rdrr.io/pkg/tmap/man/tmap-element.html'>tmap-element</a></code> that specifies facets (small multiples). Small multiples can be created in two ways: 1) by specifying the <code>by</code> argument with one or two variable names, by which the data is grouped, 2) by specifying multiple variable names in any of the aesthetic argument of the layer functions (for instance, the argument <code>col</code> in <code><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></code>). This function further specifies the facets, for instance number of rows and columns, and whether the coordinate and scales are fixed or free (i.e. independent of each other). An overview of the different approaches to create facets is provided in the examples.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span>(
  by = <span class='kw'>NULL</span>,
  along = <span class='kw'>NULL</span>,
  as.layers = <span class='fl'>FALSE</span>,
  ncol = <span class='fl'>NA</span>,
  nrow = <span class='fl'>NA</span>,
  free.coords = <span class='op'>!</span><span class='kw'>as.layers</span>,
  drop.units = <span class='fl'>TRUE</span>,
  drop.empty.facets = <span class='fl'>TRUE</span>,
  drop.NA.facets = <span class='fl'>FALSE</span>,
  sync = <span class='fl'>NA</span>,
  showNA = <span class='fl'>NA</span>,
  textNA = <span class='st'>"Missing"</span>,
  free.scales = <span class='kw'>NULL</span>,
  free.scales.fill = <span class='kw'>NULL</span>,
  free.scales.symbol.size = <span class='kw'>NULL</span>,
  free.scales.symbol.col = <span class='kw'>NULL</span>,
  free.scales.symbol.shape = <span class='kw'>NULL</span>,
  free.scales.text.size = <span class='kw'>NULL</span>,
  free.scales.text.col = <span class='kw'>NULL</span>,
  free.scales.line.col = <span class='kw'>NULL</span>,
  free.scales.line.lwd = <span class='kw'>NULL</span>,
  free.scales.raster = <span class='kw'>NULL</span>,
  inside.original.bbox = <span class='fl'>FALSE</span>,
  scale.factor = <span class='fl'>2</span>,
  drop.shapes = <span class='kw'>drop.units</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>by</th>
      <td><p>data variable name by which the data is split, or a vector of two variable names to split the data by two variables (where the first is used for the rows and the second for the columns).</p></td>
    </tr>
    <tr>
      <th>along</th>
      <td><p>data variable name by which the data is split and plotted on separate pages. This is especially useful for animations made with <code><a href='https://rdrr.io/pkg/tmap/man/tmap_animation.html'>tmap_animation</a></code>. The <code>along</code> argument can be used in combination with the <code>by</code> argument. It is only supported in <code>"plot"</code> mode (so not in <code>"view"</code> mode).</p></td>
    </tr>
    <tr>
      <th>as.layers</th>
      <td><p>logical that determines whether facets are shown as different layers in <code>"view"</code> mode. By default <code>FALSE</code>, i.e. facets are drawn as small multiples.</p></td>
    </tr>
    <tr>
      <th>ncol</th>
      <td><p>number of columns of the small multiples grid. Not applicable if <code>by</code> contains two variable names.</p></td>
    </tr>
    <tr>
      <th>nrow</th>
      <td><p>number of rows of the small multiples grid. Not applicable if <code>by</code> contains two variable names.</p></td>
    </tr>
    <tr>
      <th>free.coords</th>
      <td><p>logical. If the <code>by</code> argument is specified, should each map has its own coordinate ranges? By default <code>TRUE</code>, unless facets are shown in as different layers (<code>as.layers = TRUE</code>)</p></td>
    </tr>
    <tr>
      <th>drop.units</th>
      <td><p>logical. If the <code>by</code> argument is specified, should non-selected spatial units be dropped? If <code>FALSE</code>, they are plotted where mapped aesthetics are regarded as missing values. Not applicable for raster shapes. By default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>drop.empty.facets</th>
      <td><p>logical. If the <code>by</code> argument is specified, should empty facets be dropped? Empty facets occur when the <code>by</code>-variable contains unused levels. When <code>TRUE</code> and two <code>by</code>-variables are specified, empty rows and columns are dropped.</p></td>
    </tr>
    <tr>
      <th>drop.NA.facets</th>
      <td><p>logical. If the <code>by</code> argument is specified, and all values of the defined aesthetic variables (e.g. <code>col</code> from <code><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></code>) for specific facets, should these facets be dropped? <code>FALSE</code> by default.</p></td>
    </tr>
    <tr>
      <th>sync</th>
      <td><p>logical. Should the navigation in view mode (zooming and panning) be synchronized? By default <code>TRUE</code> if the facets have the same bounding box. This is generally the case when <code><a href='https://rdrr.io/pkg/raster/man/raster-package.html'>raster</a></code>s are plotted, or when free.coords is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>showNA</th>
      <td><p>If the <code>by</code> argument is specified, should missing values of the <code>by</code>-variable be shown in a facet? If two <code>by</code>-variables are specified, should missing values be shown in an additional row and column? If <code>NA</code>, missing values only are shown if they exist. Similar to the <code>useNA</code> argument of <code><a href='https://rdrr.io/r/base/table.html'>table</a></code>, where <code>TRUE</code>, <code>FALSE</code>, and <code>NA</code> correspond to <code>"always"</code>, <code>"no"</code>, and <code>"ifany"</code> respectively.</p></td>
    </tr>
    <tr>
      <th>textNA</th>
      <td><p>text used for facets of missing values.</p></td>
    </tr>
    <tr>
      <th>free.scales</th>
      <td><p>logical. Should all scales of the plotted data variables be free, i.e. independent of each other? Specific scales can be set with <code>free.scales.x</code>, where <code>x</code> is the name of the aesthetic, e.g. <code>"symbol.col"</code>. By default, <code>free.scales</code> is <code>TRUE</code>, unless the <code>by</code> argument is used, the <code>along</code> argument is used, or a <code>stars</code> object with a third dimension is shown.</p></td>
    </tr>
    <tr>
      <th>free.scales.fill</th>
      <td><p>logical. Should the color scale for the choropleth be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.symbol.size</th>
      <td><p>logical. Should the symbol size scale for the symbol map be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.symbol.col</th>
      <td><p>logical. Should the color scale for the symbol map be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.symbol.shape</th>
      <td><p>logical. Should the symbol shape scale for the symbol map be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.text.size</th>
      <td><p>logical. Should the text size scale be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.text.col</th>
      <td><p>logical. Should the text color scale be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.line.col</th>
      <td><p>Should the line color scale be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.line.lwd</th>
      <td><p>Should the line width scale be free?</p></td>
    </tr>
    <tr>
      <th>free.scales.raster</th>
      <td><p>Should the color scale for raster layers be free?</p></td>
    </tr>
    <tr>
      <th>inside.original.bbox</th>
      <td><p>If <code>free.coords</code>, should the bounding box of each small multiple be inside the original bounding box?</p></td>
    </tr>
    <tr>
      <th>scale.factor</th>
      <td><p>Number that determines how the elements (e.g. font sizes, symbol sizes, line widths) of the small multiples are scaled in relation to the scaling factor of the shapes. The elements are scaled to the <code>scale.factor</code>th root of the scaling factor of the shapes. So, for <code>scale.factor=1</code>, they are scaled proportional to the scaling of the shapes. Since elements, especially text, are often too small to read, a higher value is recommended. By default, <code>scale.factor=2</code>.</p></td>
    </tr>
    <tr>
      <th>drop.shapes</th>
      <td><p>deprecated: renamed to <code>drop.units</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='https://rdrr.io/pkg/tmap/man/tmap-element.html'>tmap-element</a></code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The global option <code>limits</code> controls the limit of the number of facets that are plotted. By default, <code><a href='https://rdrr.io/pkg/tmap/man/tmap_options.html'>tmap_options(limits=c(facets.plot=64, facets.view=4))</a></code>. The maximum number of interactive facets is set to four since otherwise it may become very slow.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Tennekes, M., 2018, tmap: Thematic Maps in R, Journal of Statistical Software, 84(6), 1-39, <a href='https://doi.org/10.18637/jss.v084.i06'>DOI</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='../doc/tmap-getstarted.html'><code>vignette("tmap-getstarted")</code></a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>World</span>, <span class='kw'>NLD_muni</span>, <span class='kw'>NLD_prov</span>, <span class='kw'>land</span>, <span class='kw'>metro</span>)

<span class='kw'>current.mode</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span>(<span class='st'>"plot"</span>)</div><div class='output co'>#&gt; <span class='message'>tmap mode set to plotting</span></div><div class='input'>
<span class='co'># CASE 1: Facets defined by constant values</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>World</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"forestgreen"</span>, <span class='st'>"goldenrod"</span>)) <span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_format</a></span>(<span class='st'>"World"</span>, title=<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A green world"</span>, <span class='st'>"A dry world"</span>), bg.color=<span class='st'>"lightskyblue2"</span>, 
    title.position=<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"left"</span>, <span class='st'>"bottom"</span>))</div><div class='img'><img src='tm_facets-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># CASE 2: Facets defined by multiple variables</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>World</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_polygons</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"well_being"</span>, <span class='st'>"life_exp"</span>),
    	style=c("<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>r<span class='st'>"pretty"</span>fi<span class='st'>"fixed"</span>breaks=lis<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>L<span class='kw'>NULL</span>eq<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>,<span class='fl'>45</span>5,<span class='fl'>85</span>y = 5))<span class='fl'>5</span>
    	palette=lis<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>r<span class='st'>"Oranges"</span>Pu<span class='st'>"Purples"</span>
    	border.col = "bl<span class='st'>"black"</span>
        title=<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Well-Being Index"</span>, <span class='st'>"Life Expectancy"</span>)) <span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_format</a></span>(<span class='st'>"World"</span>)</div><div class='img'><img src='tm_facets-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>NLD_muni</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"pop_0_14"</span>, <span class='st'>"pop_15_24"</span>, <span class='st'>"pop_25_44"</span>, <span class='st'>"pop_45_64"</span>, <span class='st'>"pop_65plus"</span>),
        style=<span class='st'>"kmeans"</span>, 
        palette=<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"Oranges"</span>, <span class='st'>"Greens"</span>, <span class='st'>"Blues"</span>, <span class='st'>"Purples"</span>, <span class='st'>"Greys"</span>),
        title=<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Population 0 to 14"</span>, <span class='st'>"Population 15 to 24"</span>, <span class='st'>"Population 25 to 44"</span>,
            <span class='st'>"Population 45 to 64"</span>, <span class='st'>"Population 65 and older"</span>)) <span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>NLD_prov</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span>() <span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_format</a></span>(<span class='st'>"NLD"</span>, frame = <span class='fl'>TRUE</span>, asp=<span class='fl'>0</span>)
}

<span class='co'># CASE 3: Facets defined by group-by variable(s)</span>
<span class='co'># A group-by variable that divides the objects spatially</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>NLD_prov</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_polygons</a></span>(<span class='st'>"gold2"</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span>(by=<span class='st'>"name"</span>)</div><div class='img'><img src='tm_facets-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>NLD_muni</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span>() <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span>(by=<span class='st'>"province"</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span>(<span class='st'>"population"</span>, style=<span class='st'>"kmeans"</span>, convert2density = <span class='fl'>TRUE</span>) <span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>NLD_prov</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_borders</a></span>(lwd=<span class='fl'>4</span>) <span class='op'>+</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span>(by=<span class='st'>"name"</span>)
}

<span class='co'># The objects are divided by a non-spatial variable (e.g. date/time)</span>
<span class='co'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='kw'><a href='https://dplyr.tidyverse.org'>dplyr</a></span>) <span class='op'>&amp;&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='kw'><a href='https://tidyr.tidyverse.org'>tidyr</a></span>)) {
	metro_l<span class='kw'>metro_long</span>r<span class='op'>&lt;-</span>%<span class='kw'>metro</span><span class='op'>%&gt;%</span>
		gather(year, p<span class='fu'><a href='https://tidyr.tidyverse.org/reference/gather.html'>gather</a></span>i<span class='kw'>year</span>-n<span class='kw'>population</span>_l<span class='op'>-</span><span class='kw'>name</span>-i<span class='op'>-</span><span class='kw'>name_long</span>om<span class='op'>-</span><span class='kw'>iso_a3</span>>%<span class='op'>-</span><span class='kw'>geometry</span><span class='op'>%&gt;%</span>
		mutate(year = <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>eger(sub<span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span>4<span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='kw'>year</span><span class='fl'>4</span><span class='fl'>7</span>
	
	tm_shap<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>l<span class='kw'>metro_long</span><span class='op'>+</span>
		tm_bubbles("po<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_symbols.html'>tm_bubbles</a></span> <span class='st'>"population"</span><span class='op'>+</span>
		tm_facets(by =<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span><span class='st'>"year"</span>
}</div><div class='output co'>#&gt; <span class='message'>Loading required package: dplyr</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: tidyr</span></div><div class='img'><img src='tm_facets-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>land</span>) <span class='op'>+</span>
	tm_rast<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_raster.html'>tm_raster</a></span>"<span class='st'>"black"</span><span class='op'>+</span>
	tm_face<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span>ver_<span class='st'>"cover_cls"</span>
}

<span class='co'># Facets defined by two group-by variables</span>
<span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='kw'>World</span><span class='op'>$</span><span class='kw'>HPI3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='kw'>World</span><span class='op'>$</span><span class='kw'>HPI</span>, breaks = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>, <span class='fl'>35</span>, <span class='fl'>50</span>, <span class='fl'>65</span>), 
    labels = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"HPI low"</span>, <span class='st'>"HPI medium"</span>, <span class='st'>"HPI high"</span>))
<span class='kw'>World</span><span class='op'>$</span><span class='kw'>GDP3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='kw'>World</span><span class='op'>$</span><span class='kw'>gdp_cap_est</span>, breaks = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>5000</span>, <span class='fl'>20000</span>, <span class='fl'>Inf</span>), 
    labels = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"GDP low"</span>, <span class='st'>"GDP medium"</span>, <span class='st'>"GDP high"</span>))

<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>World</span>) <span class='op'>+</span> 
	tm_fill<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span>,<span class='st'>"HPI3"</span>te="Dark2"<span class='st'>"Dark2"</span>NA="grey90<span class='st'>"grey90"</span>d.show = FALSE) <span class='fl'>FALSE</span><span class='op'>+</span>
	tm_face<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span>3<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>,<span class='st'>"HPI3"</span>")<span class='st'>"GDP3"</span>NA=FALSE, <span class='fl'>FALSE</span>coords = FALSE, <span class='fl'>FALSE</span>units = FALSE)<span class='fl'>FALSE</span>

<span class='kw'>metro_edited</span> <span class='op'>&lt;-</span> <span class='kw'>metro</span> <span class='op'>%&gt;%</span> 
	mutate(<span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>0cat = cut(pop<span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>0<span class='kw'>pop1950</span>s=c(0.5, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>,<span class='fl'>0.5</span>5,<span class='fl'>1</span>2,<span class='fl'>1.5</span> 5<span class='fl'>2</span> 1<span class='fl'>3</span>, <span class='fl'>5</span>0)<span class='fl'>10</span>e6<span class='fl'>40</span><span class='op'>*</span><span class='fl'>1e6</span>
		   pop2020cat = cut(pop2020, b<span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>k<span class='kw'>pop2020</span>, 1, 1.5,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>2<span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span> 4<span class='fl'>2</span>)*<span class='fl'>3</span>e6<span class='fl'>5</span>)<span class='fl'>10</span><span class='fl'>40</span><span class='op'>*</span><span class='fl'>1e6</span>

<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>World</span>) <span class='op'>+</span>
	tm_fill<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_polygons.html'>tm_fill</a></span><span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_shape.html'>tm_shape</a></span>(<span class='kw'>metro_edited</span>) <span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_symbols.html'>tm_dots</a></span>(<span class='st'>"red"</span>, size = <span class='fl'>.5</span>) <span class='op'>+</span>
	tm_face<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_facets.html'>tm_facets</a></span>1<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>5<span class='st'>"pop1950cat"</span>02<span class='st'>"pop2020cat"</span>.coords = FALSE) <span class='fl'>FALSE</span><span class='op'>+</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tm_layout.html'>tm_layout</a></span>(panel.label.rot = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>90</span>), panel.label.size = <span class='fl'>2</span>)
}

<span class='co'># restore current mode</span>
<span class='fu'><a href='https://rdrr.io/pkg/tmap/man/tmap_mode.html'>tmap_mode</a></span>(<span class='kw'>current.mode</span>)</div><div class='output co'>#&gt; <span class='message'>tmap mode set to plotting</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Martijn Tennekes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


